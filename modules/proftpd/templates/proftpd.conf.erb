# Base server settings
ServerName              <%= scope.lookupvar('proftpd::params::servername') %>
ServerType              standalone
DefaultServer           on

#DefaultAddress          localhost
Port                    <%= scope.lookupvar('proftpd::params::port') %>
PassivePorts            <%= scope.lookupvar('proftpd::params::passiveports') %>
TimesGMT                off                     # use local time
MaxInstances            <%= scope.lookupvar('proftpd::params::maxinstances') %>
MaxClients              <%= scope.lookupvar('proftpd::params::maxclients') %> "Connection is full"
MaxClientsPerHost       <%= scope.lookupvar('proftpd::params::maxclientsperhost') %>

UseIPv6                 off

Umask                   <%= scope.lookupvar('proftpd::params::file_umask') %> <%= scope.lookupvar('proftpd::params::directory_umask') %>

User                    <%= scope.lookupvar('proftpd::params::user') %>
Group                   <%= scope.lookupvar('proftpd::params::group') %>

DefaultRoot             <%= scope.lookupvar('proftpd::params::global_defaultroot') %>

AllowOverwrite          <%= scope.lookupvar('proftpd::params::allowoverwrite') %>
AllowStoreRestart       <%= scope.lookupvar('proftpd::params::allowstorerestart') %>
AllowRetrieveRestart    <%= scope.lookupvar('proftpd::params::allowretrieverestart') %>

UseReverseDNS           <%= scope.lookupvar('proftpd::params::usereversedns') %>
IdentLookups            <%= scope.lookupvar('proftpd::params::identlookups') %>

TimeoutIdle             <%= scope.lookupvar('proftpd::params::timeoutidle') %> 
TimeoutLogin            <%= scope.lookupvar('proftpd::params::timeoutlogin') %>
TimeoutNoTransfer       <%= scope.lookupvar('proftpd::params::timeoutnotransfer') %>
TimeoutStalled          <%= scope.lookupvar('proftpd::params::timeoutstalled') %>

#PathAllowFilter         "[a-zA-Z0-9]"
#PathDenyFilter          "(\.ftp)|(\.htaccess)|(\.me)[a-z]+$"

RequireValidShell       off
CreateHome              on

PidFile                 <%= scope.lookupvar('proftpd::params::pid_dir') %>/proftpd.pid
SystemLog               <%= scope.lookupvar('proftpd::params::log_dir') %>/proftpd.log
DisplayLogin            <%= scope.lookupvar('proftpd::params::conf_dir') %>/welcome.msg
DisplayChdir            .message

<Directory <%= scope.lookupvar('proftpd::params::pub_dir') %>>
  TransferRate          STOR <%= scope.lookupvar('proftpd::params::pub_transferrate_stor') %>:<%= scope.lookupvar('proftpd::params::pub_transferrate_quota_stor') %>
  TransferRate          RETR <%= scope.lookupvar('proftpd::params::pub_transferrate_retr') %>:<%= scope.lookupvar('proftpd::params::pub_transferrate_quota_retr') %>
  <Limit RMD DELE STOR SITE_CHMOD>
    DenyUser pub
  </Limit>
</Directory>

# Bar use of SITE CHMOD by default
<Limit SITE_CHMOD>
  DenyAll
</Limit>

# A basic anonymous configuration, no upload directories.  If you do not
# want anonymous users, simply delete this entire <Anonymous> section.
#<Anonymous ~ftp>
#  User                       ftp
#  Group                      ftp
#
#  # We want clients to be able to login with "anonymous" as well as "ftp"
#  UserAlias                  anonymous ftp
#
#  # Limit the maximum number of anonymous logins
#  MaxClients                 10
#
#  # We want 'welcome.msg' displayed at login, and '.message' displayed
#  # in each newly chdired directory.
#  DisplayLogin               $sysconfdir/welcome.msg
#  DisplayChdir               .message
#
#  # Limit WRITE everywhere in the anonymous chroot
#  <Limit WRITE>
#    DenyAll
#  </Limit>
#</Anonymous>

include <%= scope.lookupvar('proftpd::params::conf_dir') %>/conf.d/*.conf
